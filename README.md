![StudioD Logo](https://storage-studiod.ams3.digitaloceanspaces.com/prod/0165905a073e76c236e13c812ff8933f.jpg)

# StudioD

Bienvenue sur le dépôt du code de cette plateforme solidaire de mise à disposition de studios de danse initiée par le [CDCN Ateliers de Paris](https://www.atelierdeparis.org/).

Parmi les fonctionnalités principales :
- Système de modération des nouvelles inscriptions
- Côté lieu, un dashboard complet permet de créer de nouveaux espaces, de gérer leur disponibilités, les demandes de réservation, les confirmations, annulations, etc.
- Côté compagnie de danse, on peut faire une recherche par période, par lieu, par filtre sur différents critères techniques. On a également un dashboard complet pour gérer ses demandes et réservations à venir.
- La caractère solidaire de la plateforme est pris en compte *by design*. Il n'y a pas de bloc de paiement implémenté et lorsqu'un créneau d'un espace fait l'objet d'une demande, aucune autre compagnie ne peut faire une demande compétitive. En retour, une compagnie ne pas faire plusieurs demandes auprès de différents espaces pour un même créneau, ceci pour éviter là aussi de mettre en compétition les lieux.
- Une messagerie interne permet les échanges entre compagnies et lieux au sein de la plateforme.
- De nombreuses notifications par email sont implémentées.
- La gestion côté administration de la plateforme est facilitée par Strapi grâce à son dashboard complet et facile d'utilisation.
- L'ensemble des textes sont rassemblés dans des fichiers json ce qui facilite la traduction de la plateforme ou son adaptation à un autre contexte d'usage.

# How to make it run?

The project is divided in two parts:
- web : Next.js
- back : Strapi (Node Js server)

## QuickStart


```bash
# Start infrastructure (database, local email service)
docker-compose up

# Install all dependencies
yarn install
```

## Front

Start the project

``` bash
# Development
yarn client:dev

# Production
yarn client:build
yarn client:start
```
Default url: [http://localhost:1337](http://localhost:1337)

## Back

Start the project

``` bash
# Development
yarn server:dev

# Production
yarn server:build
yarn server:start
```

Default url: [http://localhost:3000](http://localhost:3000)

## Email
Email templates are located in folder `back/email-templates.sql`, you must execute those queries into a sql database client, then you will be able to find them in strapi, left menu go to Plugins > Email Designer

If you create new email templates from strapi keep in mind that you have to export them from your sql client as INSERT queries and update `back/email-templates.sql`

## Deployment
Staging deployment is launched when new code is either pushed or merged on **develop** branch
Production deployment is launched when new code is either pushed or merged on **master** branch

## Environment vars
Rename files `.env.dist` into `.env` and fill empty values

## Swagger documentation
Swagger types are automatically generated by strapi and are used to generated typescript interfaces `web/typings/api.ts`.  
They can be overrided for each entity under `back/api/ENTITY/documentation/VERSION/overrides/ENTITY.json`, then you must regenerate the documentation from strapi, Plugins > Documentation > Recreate, then execute command `yarn get-types`
